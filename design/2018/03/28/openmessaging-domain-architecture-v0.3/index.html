<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>OpenMessaging Domain Architecture</title>
  <meta name="description" content="OpenMessaging has released three alpha versions recently and the newest version is 0.2.0-alpha, the domain architecture has a great evolution beyond the firs...">

  <link rel="stylesheet" href="/css/foundation.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/font-awesome.css">
  <link rel="stylesheet" href="/css/syntax.css">

  <script src="/javascripts/libs.js" type="text/javascript"></script>
  <script>
    var _hmt = _hmt || []; //define it for baidu seo

    // terrificjs bootstrap
    (function($) {
        $(document).ready(function() {
            var $page = $('body');
            var config = {
              dependencyPath: {
                plugin: 'javascripts/'
              }
            }
            var application = new Tc.Application($page, config);
            application.registerModules();
            application.start();

            //Add baidu seo
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?da02b4505574c2f46febdc0874af5c8b";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        });
    })(Tc.$);
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89603173-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-89603173-2');
  </script>

  <link href="http://fonts.googleapis.com/css?family=Raleway:400,700,300" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/masonry.pkgd.js" type="text/javascript"></script>
  <script src="/javascripts/imagesloaded.pkgd.min.js" type="text/javascript"></script>
  <script src="/javascripts/slick.min.js" type="text/javascript"></script>

  <link rel="canonical" href="/design/2018/03/28/openmessaging-domain-architecture-v0.3/">
  <link rel="alternate" type="application/rss+xml" title="OpenMessaging" href="/feed.xml" />
</head>


  <body>

    <a href="" id="top"></a>
<div style="width: 100%; background-color: rgb(235, 235, 235);">
    <div style="max-width: 80rem; margin: 0 auto; margin-bottom: 0; padding-left: 20px">
      <a class='' href="https://www.linuxfoundation.org/">
        <img alt="" src="/images/linux-foundation-logo.png" style="height: 18px" />
      </a>
    </div>
</div>
<div class='navbar contain-to-grid sticky'>
  <nav class='top-bar' data-options='sticky_on: large' data-topbar=''>
    <ul class='title-area'>
      <li class='name'>
        <h1>
          <a href="">
            <img alt="" src="/images/oms-logo.png" />
          </a>

        </h1>

      </li>
      <li class='toggle-topbar menu-icon'>
        <a href='#'>Menu</a>
      </li>
    </ul>
    <section class='top-bar-section'>
      <ul class="right">
        
          

          
            <li class="">
              <a href="/">Home</a>
            </li>
          
        
          

          
            <li class="has-dropdown ">
              <a href="/">Docs</a>
              <ul class='dropdown'>
                
                  <li>
                    <a href="/openmessaging-java">Java APIs</a>
                  </li>
                
                  <li>
                    <a href="/docs/benchmarks">Benchmarks</a>
                  </li>
                
              </ul>
            </li>
          
        
          

          
            <li class="">
              <a href="/blog">Blog</a>
            </li>
          
        
          

          
            <li class="">
              <a href="/community">Community</a>
            </li>
          
        
          

          
            <li class="">
              <a href="/members">Members</a>
            </li>
          
        
          

          
            <li class="has-dropdown ">
              <a href="/">About</a>
              <ul class='dropdown'>
                
                  <li>
                    <a href="/charter">Charter</a>
                  </li>
                
                  <li>
                    <a href="/contribution">Contribution</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </section>
  </nav>
</div>


    <div id='main' role='main'>
      <div class="full">
  <div class="row">
    <div class="large-9 columns">
      <div class='mod modBlogPost big no_bg'>
  <div class='images'>
    
      <div class='image'><img alt="" src="/images/@blog/oms-domain-design-v0.3.png" /></div>
    
  </div>
  <div class='content'>
    <p class='info'>
      <span>March 28, 2018</span>
      /
      <span>
        by
        <a href="">yukon</a>
      </span>
      /
      <span>
        In
        
          <a href="#">design</a>
          
        
      </span>
      <!-- /
      <span>
        <a href="#">4 commetns</a>
      </span> -->
    </p>
    <h3><a href="/design/2018/03/28/openmessaging-domain-architecture-v0.3/">OpenMessaging Domain Architecture</a></h3>
    <p>Above is the v0.3 domain architecture of Open Messaging, see <a href="/openmessaging-java">JavaDoc</a> for details.</p>

<p>The topic concept has been removed from the model, compared to the first version. And the Stream element has been introduced to this version which is a abstract concept of partition, shard, message group, etc.</p>

<p>The following sub sections demonstrate these concepts introduced to OMS.</p>

<h2 id="namespace">Namespace</h2>

<p>Namespace likes a cgroup namespace, to create an isolated space with security guarantee. Each namespace has its own set of producer, consumer, topic, queue and so on. OpenMessaging uses MessagingAccessPoint to access/read/write the resources of a specified Namespace.</p>

<h2 id="producer">Producer</h2>

<p>OpenMessaging defines two kinds of Producer: Producer and BatchMessageSender.</p>

<ul>
  <li>Producer, provides various send methods to send a message to a specified destination which is a queue in OMS.</li>
  <li>BatchMessageSender, focuses on speed, the implementation can adopt the batch way, send many messages and then commit at once.</li>
</ul>

<h2 id="consumer">Consumer</h2>

<p>OpenMessaging defines three kinds of Consumer: PullConsumer, PushConsumer and StreamingConsumer. Each consumer only supports consume messages from the Queue.</p>

<ul>
  <li>PullConsumer, pulls messages from the specified queue, supports submit the consume result by acknowledgement at any time. One PullConsumer only can pull messages from one fixed queue.</li>
  <li>PushConsumer, receives messages from multiple queues, these messages are pushed from the MOM server. PushConsumer can attach to multiple queues with separate MessageListener and submit consume result through ReceivedMessageContext at any time.</li>
  <li>StreamingConsumer, a brand-new consumer type, a stream-oriented consumer, to integrate messaging system with Streaming/BigData related platforms easily. StreamingConsumer supports consume messages from streams of a specified queue like a iterator.</li>
</ul>

<h2 id="queue">Queue</h2>

<p>Queue is the basic and core concept of OMS, the source of a Queue can be a producer or a routing.</p>

<p>It is noteworthy that a Queue may be divided into streams, a message will be dispatched to a specified stream by MessageHeader#STREAM_KEY.</p>

<p>Queue also accepts messages from Producer directly, sometimes, we want to the shortest path from Producer to Consumer, for performance.</p>

<h2 id="routing">Routing</h2>

<p>The Routing is in charge of processing the original messages in source queue, and routing to another queue. Each Routing is a triple consists of source queue, destination queue and expression. The messages will flow through the expression from source queue and destination queue.</p>

<p>The expression is used to handle the flowing messages in Routing. There are many kinds of expression, the filter expression is the most commonly used in many scenarios and is the only type defined by this OMS version. In the future, the OMS may support deduplicator exp., joiner exp., rpc exp., and so on.</p>

<p>Whatâ€™s more? Routing can cross the network, message can be routed from a network partition to another partition.</p>

  </div>
</div>
<div class='two spacing'></div>
<a id='comments'></a>
<div class='comments-wrapper'>
  <!-- <h3 class='comments-count'>6 Comments</h3>
  <ul class='comments'>
    <li>
      <div class='meta'>
        <p class='avatar'>
          <img width="39" height="39" alt="" src="/images/avatar.png" />
        </p>
        <p class='info'>
          <span class='name'>Amy</span>
          <span class='datetime'>October 15, 2011 at 3:30 pm</span>
          <a href='#comment-form'>Reply</a>
        </p>
      </div>
      <p>
        Laudantium et sint repellat eum necessitatibus aut est rem illo delectus saepe. dolor consectetur et dolorem distinctio beatae doloribus magni ducimus reprehenderit voluptatibus ex officia quia. cum facere est quas provident ea nam quibusdam deserunt quis. error quis nihil ad quia corrupti asperiores labore quis error ut debitis nobis iste. laborum sint qui aut asperiores numquam itaque ea illum
      </p>
    </li>
    <li>
      <div class='meta'>
        <p class='avatar'>
          <img width="39" height="39" alt="" src="/images/avatar.png" />
        </p>
        <p class='info'>
          <span class='name'>Amy</span>
          <span class='datetime'>October 15, 2011 at 3:30 pm</span>
          <a href='#comment-form'>Reply</a>
        </p>
      </div>
      <p>Quam cumque magni voluptas. possimus neque in voluptates. quia consequatur voluptas eum aut mollitia ipsa commodi. sint vero earum illo sequi omnis officiis velit nihil dolor quo quisquam sint. impedit ut quisquam sed placeat et quia nam possimus veniam possimus at qui. ipsam architecto ducimus similique modi non autem consequatur soluta</p>
      <ul class='children'>
        <li>
          <div class='meta'>
            <p class='avatar'>
              <img width="39" height="39" alt="" src="/images/avatar.png" />
            </p>
            <p class='info'>
              <span class='name'>Amy</span>
              <span class='datetime'>October 15, 2011 at 3:30 pm</span>
              <a href='#comment-form'>Reply</a>
            </p>
          </div>
          <p>Quas ut vel nobis veniam explicabo consequatur. iusto nisi eius iure voluptas perferendis omnis quod excepturi et eum. sed porro tenetur ut unde suscipit optio ipsum molestiae</p>
        </li>
      </ul>
    </li>
    <li>
      <div class='meta'>
        <p class='avatar'>
          <img width="39" height="39" alt="" src="/images/avatar.png" />
        </p>
        <p class='info'>
          <span class='name'>Amy</span>
          <span class='datetime'>October 15, 2011 at 3:30 pm</span>
          <a href='#comment-form'>Reply</a>
        </p>
      </div>
      <p>Deleniti omnis magnam officiis tempora et suscipit quam voluptates magni magnam aut recusandae fuga. et molestiae natus harum libero. et dignissimos qui id est natus architecto quisquam non quo voluptas dignissimos et quibusdam. id saepe laudantium ipsum labore dolorum officia et odio debitis et. consequatur non veniam deserunt rerum nihil sint est</p>
    </li>
  </ul> -->
</div>
<div class='four spacing'></div>
<!-- <div id='comment-form'>
  <h3>Your comment</h3>
  <form accept-charset='UTF-8' action='#' method='post'>
    <p class='name'>
      <label for='name'>Your Name</label>
      <input class='input-text required' id='name' name='name' type='text'>
    </p>
    <p class='email'>
      <label for='email'>Your Email</label>
      <input class='input-text required' id='email' name='email' type='text'>
    </p>
    <p class='message'>
      <label for='message'>Your Message</label>
      <textarea class='required' cols='80' id='message' name='message' rows='5'></textarea>
    </p>
    <div class='spacing'></div>
    <p>
      <input class='button' type='submit' value='Send Message'>
    </p>
  </form>
</div> -->
<div class='four spacing'></div>


    </div>
    <div class="large-3 columns" id="sidebar">
      <!-- <div class='links'>
  <h3>Archives</h3>
  <ul>
    <li>
      <a href='#'>December 2011</a>
      <span>(2)</span>
    </li>
    <li>
      <a href='#'>November 2011</a>
      <span>(4)</span>
    </li>
    <li>
      <a href='#'>October 2011</a>
      <span>(1)</span>
    </li>
    <li>
      <a href='#'>September 2011</a>
      <span>(3)</span>
    </li>
    <li>
      <a href='#'>July 2011</a>
      <span>(5)</span>
    </li>
    <li>
      <a href='#'>June 2011</a>
      <span>(3)</span>
    </li>
    <li>
      <a href='#'>May 2011</a>
      <span>(6)</span>
    </li>
    <li>
      <a href='#'>April 2011</a>
      <span>(1)</span>
    </li>
  </ul>
</div>
<div class='links'>
  <h3>Categories</h3>
  <ul>
    
      <li><a href="#">Design</a></li>
    
      <li><a href="#">News</a></li>
    
  </ul>
</div> -->
<div class='links'>
  <h3>Recent Posts</h3>
  <ul>
    
      
      <li><a href="/news/2019/03/08/21vianet-talkingdata-qiniucloud-360-finance-qingyuan-cloud-and-bingocloud-join-the-openmessaging-project/">21vianet enterprise cloud, talkingdata, qiniu cloud, 360 finance, qingyuan cloud and bingocloud join the openmessaging project</a></li>
    
      
      <li><a href="/news/2019/02/11/jd-cloud-iflytek-and-vipkid-join-the-openmessaging-project/">Jd cloud, iflytek and vipkid join the openmessaging project</a></li>
    
      
      <li><a href="/news/2019/01/17/yahoo-japan-and-emq-x-join-the-openmessaging-project/">Yahoo! japan and emq x join the openmessaging project</a></li>
    
      
      <li><a href="/news/2018/10/05/jingdong-jd-com-china-mobile-cloud-qing-cloud-and-whale-cloud-join-the-openmessaging-project/">Jingdong (jd.com), china mobile cloud, qingcloud, and whale cloud join the openmessaging project</a></li>
    
      
      <li><a href="/news/2018/09/06/Webank-and-DataPipeline-Join-OpenMessaging-to-Build-an-Open-Standard-for-Distributed-Messaging/">Webank and datapipeline join openmessaging to build an open standard for distributed messaging</a></li>
    
      
      <li><a href="/design/2018/03/28/openmessaging-domain-architecture-v0.3/">Openmessaging domain architecture</a></li>
    
      
        
  </ul>
</div>
<!-- <div class='links'>
  <h3>Tags</h3>
  <ul>
    
  </ul>
</div>
<div class='four spacing'></div> -->

    </div>
  </div>
</div>

    </div>

    <div id='footer'>
  <div class='three spacing'></div>
  <div class='row'>
    <div class='large-7 medium-3 columns'>
      <h3>
        <a href='index.html'>
          <img alt="" src="/images/oms-white-logo.png" />
        </a>
      </h3>
      <p>Copyright &copy; 2017~2022 OpenMessaging Project, a Linux Foundation Collaborative Project. All Rights Reserved unless explicitly granted under an open source license.<br> The Linux Foundation is a registered trademark of The Linux Foundation. Linux is a registered trademark of Linus Torvalds.<br> Please see our <a href="https://www.linuxfoundation.org/terms" target="_blank">terms of use</a>, <a href="https://www.linuxfoundation.org/trademark-usage" target="_blank">trademark usage</a> and <a href=" https://www.linuxfoundation.org/privacy" target="_blank">privacy policy</a></p>
      <div class='spacing'></div>
      <div class='spacing'></div>
    </div>
    <div class='large-5 medium-5 columns'>
      <div class='spacing'></div>
      <h4>Contact us</h4>
      <ul>
        <li>&nbsp;&nbsp;&nbsp;<i class="fa fa-hand-o-right" ></i>&nbsp;&nbsp;&nbsp;<a href="https://groups.google.com/forum/#!forum/openmessaging">JOIN THE MAILING LIST</a></li>
      </ul>
      <div class='spacing'></div>
      <ul class='socials'>
        <li>
          <a href='https://twitter.com/Open_Messaging'>
            <i class='fa fa-twitter'></i>
          </a>
        </li>
        <li>
          <a href='https://github.com/openmessaging'>
            <i class='fa fa-github'></i>
          </a>
        </li>
        <li>
          <a href='https://openmessaging.herokuapp.com/'>
            <i class='fa fa-slack'></i>
          </a>
        </li>
      </ul>
      <div class='spacing'></div>
    </div>
  </div>
  <div class='two spacing'></div>
</div>

<script src="/javascripts/jquery.countTo.js" type="text/javascript"></script>
<script src="/javascripts/jquery.appear.js" type="text/javascript"></script>
<script src="/javascripts/jquery.validate.js" type="text/javascript"></script>
<script src="/javascripts/jquery.sequence-min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.easing.1.3.js" type="text/javascript"></script>
<script src="/javascripts/app.js" type="text/javascript"></script>


  </body>

</html>
